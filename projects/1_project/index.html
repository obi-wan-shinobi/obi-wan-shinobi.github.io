<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Galaxy EfficientNets | Shreyas Kalvankar</title> <meta name="author" content="Shreyas Kalvankar"> <meta name="description" content="A galaxy morphology classification project dubbed " the galaxy zoo> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.png?542484e64284bf0228dd312c245c2906"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://obi-wan-shinobi.github.io/projects/1_project/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Shreyas </span>Kalvankar</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/blog/">blog</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/sketches/">sketches</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Galaxy EfficientNets</h1> <p class="post-description">A galaxy morphology classification project dubbed "The Galaxy Zoo 2"</p> </header> <article> <h1 id="introduction">Introduction</h1> <p>Studying and categorizing galaxies has long been a challenge in astrophysics. Scientists have worked tirelessly to identify distinct groups of galaxies, examining their traits to understand the complex processes behind their formation. Galaxy morphology, driven by physical characteristics and orbital structures, is a key focus, where a galaxy’s gravitational potential influences its orbital families, resulting in unique appearances like bars, rings, and bulges.</p> <p>Our project aimed to create an efficient system for automated galaxy classification, reducing the labor-intensive nature of manual classification. With the growing volume of data from sky surveys, we harnessed deep learning to address this need.</p> <p>We tackled two main challenges. First, using Convolutional Neural Networks (CNNs), we quantitatively assessed morphological features to predict vote fractions. Second, we directly classified galaxy images into seven morphological classes using these predictions.</p> <p>By employing an ensemble of EfficientNet architectures, we achieved promising results in both vote-fraction predictions and image classification. Our project successfully automated galaxy classification, alleviating the human effort required for this time-consuming task.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/galaxy-zoo/samples-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/galaxy-zoo/samples-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/galaxy-zoo/samples-1400.webp"></source> <img src="/assets/img/galaxy-zoo/samples.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="galaxy classes" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Example galaxy images from the dataset. Each row represents a class. From top to bottom, their Galaxy Zoo 2 labels are class 0, 1, 2, 3, 4, 5 and 6 </div> <h1 id="dataset">Dataset</h1> <p>After the retirement of the Galaxy Zoo 1 project, a new challenge, Galaxy Zoo 2, was initiated. This project entailed the analysis of 304,122 galaxy images sourced from the Sloan Digital Sky Survey. Both Galaxy Zoo projects were citizen science endeavors that received over 16 million image classifications.</p> <p>While the original Galaxy Zoo project focused on categorizing galaxies into broad groups like early-types, late-types, or mergers, Galaxy Zoo 2 took a more granular approach by quantifying morphological features such as bars, bulges, disks, spirals, and more. It introduced a system of quantified data, providing information on the strength of bulges and the number of spiral arms.</p> <p>Our project was developed in the context of the Galaxy Zoo challenge, hosted on Kaggle, with the objective of automating galaxy classification. The primary image dataset comprised the brightest 25% of resolved galaxies from the Sloan Digital Sky Survey’s North Galactic Cap. The competition aimed to develop a generalized algorithm applicable to various images, and the dataset was meticulously selected to represent diverse colors, sizes, and morphologies.</p> <p>The training set included 61,578 RGB images with probabilities for 37 categories in the GZ2 decision tree, while the evaluation set consisted of 79,975 similar images without morphological data. The goal was to predict these probabilities with precision, transforming a classification task into a regression problem. Our model’s performance was evaluated using root-mean-squared error (RMSE) for predicted values against known probabilities.</p> <p>Additionally, the study segmented galaxies into seven classes and refined the dataset by applying thresholds based on sufficient votes. This approach facilitated more specific classifications, with class sizes ranging from 578 to 8107 samples. The resulting dataset consisted of 25,941 images, divided into a 9:1 train-test ratio, with 23,352 images for training and 2,589 for testing.</p> <table class="mb-2"> <tr> <th>Class</th> <th>Sample</th> <th>Tasks</th> <th>Selection</th> <th>Nsample</th> </tr> <tr> <td rowspan="3">0</td> <td rowspan="3">Completely round</td> <td>T01</td> <td>𝑓<sub>𝑠𝑚𝑜𝑜𝑡ℎ</sub> ≥ 0.469</td> <td rowspan="3">8107</td> </tr> <tr> <td>T07</td> <td>𝑓<sub>𝑐𝑜𝑛𝑝𝑙𝑒𝑡𝑒𝑙𝑦𝑟𝑜𝑢𝑛𝑑</sub> ≥ 0.5</td> </tr> <tr> <td>T06</td> <td>𝑓<sub>𝑜𝑑𝑑/𝑛𝑜</sub> ≥ 0.5</td> </tr> <tr> <td rowspan="3">1</td> <td rowspan="3">In-between</td> <td>T01</td> <td>𝑓<sub>𝑠𝑚𝑜𝑜𝑡ℎ</sub> ≥ 0.469</td> <td rowspan="3">7782</td> </tr> <tr> <td>T07</td> <td>𝑓<sub>𝑖𝑛−𝑏𝑒𝑡𝑤𝑒𝑒𝑛</sub> ≥ 0.5</td> </tr> <tr> <td>T06</td> <td>𝑓<sub>𝑜𝑑𝑑/𝑛𝑜</sub> ≥ 0.5</td> </tr> <tr> <td rowspan="3">2</td> <td rowspan="3">Cigar shaped</td> <td>T01</td> <td>𝑓<sub>𝑠𝑚𝑜𝑜𝑡ℎ</sub> ≥ 0.469</td> <td rowspan="3">578</td> </tr> <tr> <td>T07</td> <td>𝑓<sub>𝑐𝑜𝑛𝑝𝑙𝑒𝑡𝑒𝑙𝑦𝑟𝑜𝑢𝑛𝑑</sub> ≥ 0.5</td> </tr> <tr> <td>T06</td> <td>𝑓<sub>𝑜𝑑𝑑/𝑛𝑜</sub> ≥ 0.5</td> </tr> <tr> <td rowspan="3">3</td> <td rowspan="3">Lenticulars</td> <td>T01</td> <td>𝑓<sub>𝑓𝑒𝑎𝑡𝑢𝑟𝑒𝑠/𝑑𝑖𝑠𝑘</sub> ≥ 0.430</td> <td rowspan="3">3780</td> </tr> <tr> <td>T02</td> <td>𝑓<sub>𝑒𝑑𝑔𝑒−𝑜𝑛/𝑦𝑒𝑠</sub> ≥ 0.602</td> </tr> <tr> <td>T06</td> <td>𝑓<sub>𝑜𝑑𝑑/𝑛𝑜</sub> ≥ 0.5</td> </tr> <tr> <td rowspan="4">4</td> <td rowspan="4">Barred spirals</td> <td>T01</td> <td>𝑓<sub>𝑓𝑒𝑎𝑡𝑢𝑟𝑒/𝑑𝑖𝑠𝑘</sub> ≥ 0.430</td> <td rowspan="4">827</td> </tr> <tr> <td>T02</td> <td>𝑓<sub>𝑒𝑑𝑔𝑒−𝑜𝑛/𝑛𝑜</sub> ≥ 0.715</td> </tr> <tr> <td>T03</td> <td>𝑓<sub>𝑏𝑎𝑟/𝑦𝑒𝑠</sub> ≥ 0.715</td> </tr> <tr> <td>T04</td> <td>𝑓<sub>𝑠𝑝𝑖𝑟𝑎𝑙/𝑦𝑒𝑠</sub> ≥ 0.619</td> </tr> <tr> <td rowspan="4">5</td> <td rowspan="4">Unbarred spirals</td> <td>T01</td> <td>𝑓<sub>𝑓𝑒𝑎𝑡𝑢𝑟𝑒/𝑑𝑖𝑠𝑘</sub> ≥ 0.430</td> <td rowspan="4">3307</td> </tr> <tr> <td>T02</td> <td>𝑓<sub>𝑒𝑑𝑔𝑒−𝑜𝑛/𝑛𝑜</sub> ≥ 0.715</td> </tr> <tr> <td>T03</td> <td>𝑓<sub>𝑏𝑎𝑟/𝑛𝑜</sub> ≥ 0.715</td> </tr> <tr> <td>T04</td> <td>𝑓<sub>𝑠𝑝𝑖𝑟𝑎𝑙/𝑦𝑒𝑠</sub> ≥ 0.619</td> </tr> <tr> <td rowspan="2">6</td> <td rowspan="2">Irregular</td> <td>T06</td> <td>𝑓<sub>𝑜𝑑𝑑/𝑦𝑒𝑠</sub> ≥ 0.420</td> <td rowspan="2">1560</td> </tr> <tr> <td>T08</td> <td>𝑓<sub>𝑑𝑖𝑠𝑡𝑢𝑟𝑏𝑒𝑑|𝑖𝑟𝑟𝑒𝑔𝑢𝑙𝑎𝑟 |𝑜𝑡ℎ𝑒𝑟 |𝑚𝑒𝑟𝑔𝑒𝑟 |𝑑𝑢𝑠𝑡𝑙𝑎𝑛𝑒</sub> ≥ 0.5</td> </tr> </table> <h1 id="approach">Approach</h1> <h4 id="role-lead-researcher">Role: Lead Researcher</h4> <h4 id="approach-1">Approach</h4> <ul> <li> <p>We surveyed different papers and methods that either empirically or theoritically provided a basis for a system that could be potentially implemented. A systematic study of galaxy morphologies and classification methods involving parametric and non-parametric approaches was done.</p> </li> <li> <p>The next step after having finalized the dataset was looking for Deep Learning methods that could be used. A deeper look into CNNs revealed a set of architectures fine-tuned for this particular task. We decided to use the VGG architecture and then look into Residual learning that would potentially boost the model performance over the dataset. A rigirous study of deep learning architectures involving Convolutional Neural Networks was conducted.</p> </li> <li> <p>Having finalized the approach, it was necessary to have an experimental setup ready. We decided to set up a data pipeline and network training pipeline to train the model over the dataset. We discovered that the dataset was not enough for the model to train over, hence, we decided to use data augmentation to avoid over-fitting. We programmed the entire network in Tensorflow and keras and the pipeline was set up using python. The rutime was set up in Google Colaboratory with an Nvidia Tesla K80 GPU and we begun our search.</p> </li> <li> <p>After the experimental setup was ready, we decided to implement a variety of architectures and search for even more promising architectures along the way. We created custom models with references from empirically proven architectures and trained them over weeks. We finally decided to use the EfficientNet architectures that gave the best results.</p> </li> <li> <p>We documented results at each stage and kept training the networks while tuning the hyperparameters to achieve the best results.</p> </li> </ul> <h1 id="conclusion-and-results">Conclusion and Results</h1> <p>We achieved really decent results with the EfficientNet models but we decided to use an ensemble of more than one model to achieve a greater score so as to grab a place on the public leaderboard of the Galaxy Zoo 2 challenge.</p> <p>Our results were graded using the standard competition metric, i.e. the rmse score. We achieved an rmse score of 0.07765 and ranked in the top 3 on the public leaderboard.</p> <p>The classification model provided us with decent accuracy of 93.7% on classifying the galaxies into 7 classes with an F1 score of 0.8857.</p> </article> <h2>References</h2> <div class="publications"> <h2 class="bibliography">2020</h2> <ol class="bibliography"><li> <div class="row"> <div class="col-sm-2 preview"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/publication_preview/galazy-zoo-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/publication_preview/galazy-zoo-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/publication_preview/galazy-zoo-1400.webp"></source> <img src="/assets/img/publication_preview/galazy-zoo.jpg" class="preview z-depth-1 rounded" width="auto" height="auto" alt="galazy-zoo.jpg" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div id="kalvankar2020galaxy" class="col-sm-8"> <div class="title">Galaxy Morphology Classification using EfficientNet Architectures</div> <div class="author"> <em>Shreyas Kalvankar</em>, Hrushikesh Pandit, and Pranav Parwate</div> <div class="periodical"> 2020 </div> <div class="periodical"> </div> <div class="links"> <a class="bibtex btn btn-sm z-depth-0" role="button">Bib</a> </div> <div class="bibtex hidden"> <figure class="highlight"><pre><code class="language-bibtex" data-lang="bibtex"><span class="nc">@misc</span><span class="p">{</span><span class="nl">kalvankar2020galaxy</span><span class="p">,</span>
  <span class="na">title</span> <span class="p">=</span> <span class="s">{Galaxy Morphology Classification using EfficientNet Architectures}</span><span class="p">,</span>
  <span class="na">author</span> <span class="p">=</span> <span class="s">{Kalvankar, Shreyas and Pandit, Hrushikesh and Parwate, Pranav}</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">=</span> <span class="s">{2020}</span><span class="p">,</span>
  <span class="na">eprint</span> <span class="p">=</span> <span class="s">{2008.13611}</span><span class="p">,</span>
  <span class="na">archiveprefix</span> <span class="p">=</span> <span class="s">{arXiv}</span><span class="p">,</span>
  <span class="na">primaryclass</span> <span class="p">=</span> <span class="s">{cs.CV}</span><span class="p">,</span>
<span class="p">}</span></code></pre></figure> </div> </div> </div> </li></ol> </div> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2023 Shreyas Kalvankar. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Images are my own. Last updated: October 20, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>